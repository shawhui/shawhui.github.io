# tun/tap

用网络虚拟化的角度看，tun/tap设备属于虚拟网卡，一端连着网络协议栈，另一端连着用户态程序。tun/tap设备可以将TCP/IP 协议栈处理好的网络包发送给任何一个使用 tun/tap 驱动的进程，由用户进程处理后发送给物理链路中，这种特性很适合于数据压缩、加密。OpenVPN、Vtun、flannel等都是基于它实现隧道封装的。


tun/tap 设备是利用Linux设备文件实现内核态和用户态的数据交互，设备驱动是内核态和用户态的一个接口，访问设备文件则会调用设备驱动的相应例程。

tun/tap的工作模式如下：

tun设备和tap设备的原理相同，区别在于:

- tun 设备的 /dev/tunX 文件收到的是IP包，只能工作在L3，无法与物理网卡桥接
- tap 设备的 /dev/tapX 文件收到的是链路层包，可以与物理网卡桥接