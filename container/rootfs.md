# rootfs

任何程序运行时都会有依赖，无论是开发语言层的依赖库，还是各种系统 lib、操作系统等，不同的系统对库的要求不一样，为了让容器运行时一致，容器技术将依赖的操作系统、各种 lib 依赖整合打包在一起, 然后容器启动时，作为它的根目录（根文件系统rootfs），使得容器进程的各种依赖调用都在这个根目录里，这样就做到了环境的一致性。

也就是说rootfs代表一个容器运行阶段内部可见的文件系统视角，该文件系统下含有容器所需要的系统文件、工具、容器文件等。

传统的Linux操作系统内核启动时，内核会挂载一个只读的rootfs，当系统检测其完整性之后，决定是否将其切换为读写模式。

在容器架构中，沿用了Linux中这种rootfs思想.

Docker Daemon为容器挂载rootfs时，与传统的Linux内核相似，将其设定为只读模式。

但在rootfs挂载完毕之后， Docker Daemon利用Union Mount技术，在这个只读的rootfs之上，再挂载了一个读写的文件系统。在这里我们可以把Docker文件系统理解为：含有一个只读的rootfs和一个可读写的文件系统。容器中的进程对rootfs中的内容拥有只读权限，对于读写文件系统内容拥有读写权限。

<div  align="center">
	<img src="../assets/rootfs.png" width = "600"  align=center />
</div>


通过上图发现，容器虽然只有一个文件系统，但该文件系统由两层构成，分别为读写文件系统和只读文件系统，文件系统即有了层级 “layer”的概念。

Docker利用在前面提到的Union Mount技术将这两个两层挂载。