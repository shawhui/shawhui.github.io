# 分布式集群高可用

为了提高系统的并发支持以及系统的容错能力，最常见的方案是将多个成员采用副本的形式组成一个集群，集群副本的方案要求多个成员之间保持数据对齐，才能提供正确的服务，当单个或少数成员发生故障时，并不影响整体的可用性。集群的核心问题在于多个成员如何实现对齐？答案就是状态机。

## 状态机

状态机（State Machine）来源于数学领域，它被定义为一组状态和一个转换函数。状态机从一个初始状态，每次输入都要传入转换函数，使得状态机进入一个新的状态，在下一个输入来之前，保持状态不变。状态机具有确定性，一个确定的输入只会转化到一个确定的状态。

这个特性可以保证多个状态机从相同的初始状态开始，按照相同的顺序将一系列输入传给转换函数之后，都会达到一致的状态。

## 状态机复制

我们可以将分布式中的节点看成一个个状态机，根据状态机的特性，只要保证它们的初始状态是一致的，并且接收的操作指令顺序也是一致，无论这个指令是新增、更新、删除亦或者其他任何可能的程序行为，并正确将这些一连串操作广播给各个分布式节点，期间允许系统内部状态存在不一致的情况，但最终所有节点的状态将是一致的，这种模型被称为状态机复制（State Machine Replication）。

